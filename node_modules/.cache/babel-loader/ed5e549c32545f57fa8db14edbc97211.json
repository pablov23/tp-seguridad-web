{"ast":null,"code":"import { toast } from 'react-toastify';\nimport { parseJwt } from './utils';\nexport const backendUrl = () => {\n  if (process.env.NODE_ENV === 'production') return process.env.REACT_APP_PRODUCTION_API;\n  return process.env.REACT_APP_DEVELOPMENT_API;\n};\nexport const login = (values, setSubmitting, nav) => {\n  return fetch(`${backendUrl()}/login`, {\n    method: 'POST',\n    mode: 'cors',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(values)\n  }).then(res => res.json()).then(data => {\n    if (data['success']) {\n      localStorage.setItem('token', data['token']);\n      localStorage.removeItem('loan-form');\n      localStorage.setItem('user_id', data['user_id']);\n      nav.push('/home');\n      toast.success('Login Successful');\n    } else {\n      toast.error(`Error: ${data.msg}`, {\n        position: toast.POSITION.BOTTOM_CENTER\n      });\n    }\n\n    setSubmitting(false);\n  }).catch(err => {\n    toast('Something went wrong, Internet might be down');\n    setSubmitting(false);\n  });\n};\nexport const logout = () => {\n  let loanFormValues = localStorage.getItem('loan-form');\n\n  if (loanFormValues) {\n    let formId = localStorage.getItem('loan-form-id');\n\n    if (formId) {\n      console.log('called');\n      return fetch(`${backendUrl()}/loan/update`, {\n        method: 'POST',\n        mode: 'cors',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          'data': loanFormValues,\n          'status': 0,\n          'id': formId\n        })\n      }).then(res => res.json()).then(data => {\n        if (data['success']) {\n          toast.info('Data Saved Successfully', {\n            position: toast.POSITION.BOTTOM_CENTER\n          });\n        } else {\n          toast.info(`Error(${data['msg']}) in saving data, you have been logged out`, {\n            position: toast.POSITION.BOTTOM_CENTER\n          });\n        }\n\n        localStorage.removeItem('token');\n        localStorage.removeItem('loan-form');\n        localStorage.removeItem('user_id');\n        localStorage.removeItem('loan-form-id');\n        toast.info('Saving current form state', {\n          position: toast.POSITION.BOTTOM_CENTER\n        });\n      }).catch(err => {\n        toast('Something went wrong, Internet might be down');\n        localStorage.removeItem('token');\n        localStorage.removeItem('loan-form');\n        localStorage.removeItem('user_id');\n        localStorage.removeItem('loan-form-id');\n      });\n    } else {\n      console.log('Called');\n      return fetch(`${backendUrl()}/loan/apply`, {\n        method: 'POST',\n        mode: 'cors',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          'data': loanFormValues,\n          'status': 0,\n          'user_id': localStorage.getItem('user_id')\n        })\n      }).then(res => res.json()).then(data => {\n        if (data['success']) {\n          toast.info('Data Saved Successfully', {\n            position: toast.POSITION.BOTTOM_CENTER\n          });\n        } else {\n          toast.error(`Error(${data['msg']}) in saving data, you have been logged out`);\n        }\n\n        localStorage.removeItem('token');\n        localStorage.removeItem('loan-form');\n        localStorage.removeItem('user_id');\n        localStorage.removeItem('loan-form-id');\n        toast.info('Saving current form state', {\n          position: toast.POSITION.BOTTOM_CENTER\n        });\n      }).catch(err => {\n        toast('Something went wrong, Internet might be down');\n        localStorage.removeItem('token');\n        localStorage.removeItem('loan-form');\n        localStorage.removeItem('user_id');\n        localStorage.removeItem('loan-form-id');\n      });\n    }\n  } else {\n    localStorage.removeItem('token');\n    localStorage.removeItem('loan-form');\n    localStorage.removeItem('user_id');\n    localStorage.removeItem('loan-form-id');\n    toast.info('successfully logged out', {\n      position: toast.POSITION.BOTTOM_CENTER\n    });\n  }\n};\nexport const authenticated = () => {\n  const token = localStorage.getItem('token');\n\n  if (token) {\n    if (new Date().getTime() / 1000 < parseJwt(token).exp) {\n      return true;\n    }\n  }\n\n  return false;\n};\nexport const getLoanByStatus = (status, handleStateChange) => {\n  return fetch(`${backendUrl()}/loan/show?status=${status}&user_id=${localStorage.getItem('user_id')}`, {\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${localStorage.getItem('token')}`\n    }\n  }).then(res => res.json()).then(data => {\n    if (data['success']) {\n      if (data['token']) {\n        localStorage.setItem('token', data['token']);\n      }\n\n      handleStateChange(status, data['data']);\n    } else {\n      toast.info(JSON.stringify(data['msg']), {\n        position: toast.POSITION.BOTTOM_CENTER\n      });\n    }\n  }).catch(err => {\n    toast.info(`Error something went wrong, check your internet status`, {\n      position: toast.POSITION.BOTTOM_CENTER\n    });\n  });\n};","map":{"version":3,"sources":["/Users/pveron/Documents/facu/React-Banking-App/src/auth.js"],"names":["toast","parseJwt","backendUrl","process","env","NODE_ENV","REACT_APP_PRODUCTION_API","REACT_APP_DEVELOPMENT_API","login","values","setSubmitting","nav","fetch","method","mode","headers","body","JSON","stringify","then","res","json","data","localStorage","setItem","removeItem","push","success","error","msg","position","POSITION","BOTTOM_CENTER","catch","err","logout","loanFormValues","getItem","formId","console","log","info","authenticated","token","Date","getTime","exp","getLoanByStatus","status","handleStateChange"],"mappings":"AAAA,SAASA,KAAT,QAAsB,gBAAtB;AACA,SAASC,QAAT,QAAyB,SAAzB;AAEA,OAAO,MAAMC,UAAU,GAAG,MAAM;AAC5B,MAAGC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA5B,EAA0C,OAAOF,OAAO,CAACC,GAAR,CAAYE,wBAAnB;AAC1C,SAAOH,OAAO,CAACC,GAAR,CAAYG,yBAAnB;AACH,CAHM;AAKP,OAAO,MAAMC,KAAK,GAAG,CAACC,MAAD,EAASC,aAAT,EAAwBC,GAAxB,KAAgC;AACjD,SAAOC,KAAK,CAAE,GAAEV,UAAU,EAAG,QAAjB,EAA0B;AAClCW,IAAAA,MAAM,EAAE,MAD0B;AAElCC,IAAAA,IAAI,EAAE,MAF4B;AAGlCC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX,KAHyB;AAMlCC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeT,MAAf;AAN4B,GAA1B,CAAL,CAQNU,IARM,CAQDC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EARN,EASNF,IATM,CASDG,IAAI,IAAI;AACV,QAAIA,IAAI,CAAC,SAAD,CAAR,EAAqB;AACjBC,MAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BF,IAAI,CAAC,OAAD,CAAlC;AACAC,MAAAA,YAAY,CAACE,UAAb,CAAwB,WAAxB;AACAF,MAAAA,YAAY,CAACC,OAAb,CAAqB,SAArB,EAAgCF,IAAI,CAAC,SAAD,CAApC;AACAX,MAAAA,GAAG,CAACe,IAAJ,CAAS,OAAT;AACA1B,MAAAA,KAAK,CAAC2B,OAAN,CAAc,kBAAd;AACH,KAND,MAMO;AACH3B,MAAAA,KAAK,CAAC4B,KAAN,CAAa,UAASN,IAAI,CAACO,GAAI,EAA/B,EAAkC;AAC9BC,QAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADK,OAAlC;AAGH;;AACDtB,IAAAA,aAAa,CAAC,KAAD,CAAb;AACH,GAtBM,EAuBNuB,KAvBM,CAuBAC,GAAG,IAAI;AACVlC,IAAAA,KAAK,CAAC,8CAAD,CAAL;AACAU,IAAAA,aAAa,CAAC,KAAD,CAAb;AACH,GA1BM,CAAP;AA2BH,CA5BM;AA8BP,OAAO,MAAMyB,MAAM,GAAG,MAAM;AACxB,MAAIC,cAAc,GAAGb,YAAY,CAACc,OAAb,CAAqB,WAArB,CAArB;;AACA,MAAID,cAAJ,EAAoB;AAChB,QAAIE,MAAM,GAAGf,YAAY,CAACc,OAAb,CAAqB,cAArB,CAAb;;AACA,QAAGC,MAAH,EAAW;AACPC,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,aAAO5B,KAAK,CAAE,GAAEV,UAAU,EAAG,cAAjB,EAAgC;AACxCW,QAAAA,MAAM,EAAE,MADgC;AAExCC,QAAAA,IAAI,EAAE,MAFkC;AAGxCC,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX;AAEL,2BAAmB,UAASQ,YAAY,CAACc,OAAb,CAAqB,OAArB,CAA8B;AAFrD,SAH+B;AAOxCrB,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAC,kBAAQkB,cAAT;AAAyB,oBAAU,CAAnC;AAAsC,gBAAME;AAA5C,SAAf;AAPkC,OAAhC,CAAL,CASNnB,IATM,CASDC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EATN,EAUNF,IAVM,CAUDG,IAAI,IAAI;AACV,YAAIA,IAAI,CAAC,SAAD,CAAR,EAAqB;AACjBtB,UAAAA,KAAK,CAACyC,IAAN,CAAW,yBAAX,EAAsC;AAClCX,YAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADS,WAAtC;AAGH,SAJD,MAIO;AACHhC,UAAAA,KAAK,CAACyC,IAAN,CAAY,SAAQnB,IAAI,CAAC,KAAD,CAAQ,4CAAhC,EAA6E;AACzEQ,YAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADgD,WAA7E;AAGH;;AACDT,QAAAA,YAAY,CAACE,UAAb,CAAwB,OAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,WAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,SAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,cAAxB;AAEAzB,QAAAA,KAAK,CAACyC,IAAN,CAAW,2BAAX,EAAwC;AACpCX,UAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADW,SAAxC;AAIH,OA7BM,EA8BNC,KA9BM,CA8BAC,GAAG,IAAI;AACVlC,QAAAA,KAAK,CAAC,8CAAD,CAAL;AACAuB,QAAAA,YAAY,CAACE,UAAb,CAAwB,OAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,WAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,SAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,cAAxB;AACH,OApCM,CAAP;AAqCH,KAvCD,MAuCO;AACHc,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,aAAO5B,KAAK,CAAE,GAAEV,UAAU,EAAG,aAAjB,EAA+B;AACvCW,QAAAA,MAAM,EAAE,MAD+B;AAEvCC,QAAAA,IAAI,EAAE,MAFiC;AAGvCC,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX;AAEL,2BAAmB,UAASQ,YAAY,CAACc,OAAb,CAAqB,OAArB,CAA8B;AAFrD,SAH8B;AAOvCrB,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjB,kBAAQkB,cADS;AAEjB,oBAAU,CAFO;AAGjB,qBAAWb,YAAY,CAACc,OAAb,CAAqB,SAArB;AAHM,SAAf;AAPiC,OAA/B,CAAL,CAaNlB,IAbM,CAaDC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAbN,EAcNF,IAdM,CAcDG,IAAI,IAAI;AACV,YAAIA,IAAI,CAAC,SAAD,CAAR,EAAqB;AACjBtB,UAAAA,KAAK,CAACyC,IAAN,CAAW,yBAAX,EAAsC;AAClCX,YAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADS,WAAtC;AAGH,SAJD,MAIO;AACHhC,UAAAA,KAAK,CAAC4B,KAAN,CAAa,SAAQN,IAAI,CAAC,KAAD,CAAQ,4CAAjC;AACH;;AACDC,QAAAA,YAAY,CAACE,UAAb,CAAwB,OAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,WAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,SAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,cAAxB;AAEAzB,QAAAA,KAAK,CAACyC,IAAN,CAAW,2BAAX,EAAwC;AACpCX,UAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADW,SAAxC;AAIH,OA/BM,EAgCNC,KAhCM,CAgCAC,GAAG,IAAI;AACVlC,QAAAA,KAAK,CAAC,8CAAD,CAAL;AACAuB,QAAAA,YAAY,CAACE,UAAb,CAAwB,OAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,WAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,SAAxB;AACAF,QAAAA,YAAY,CAACE,UAAb,CAAwB,cAAxB;AACH,OAtCM,CAAP;AAuCH;AACJ,GAnFD,MAmFO;AACHF,IAAAA,YAAY,CAACE,UAAb,CAAwB,OAAxB;AACAF,IAAAA,YAAY,CAACE,UAAb,CAAwB,WAAxB;AACAF,IAAAA,YAAY,CAACE,UAAb,CAAwB,SAAxB;AACAF,IAAAA,YAAY,CAACE,UAAb,CAAwB,cAAxB;AACAzB,IAAAA,KAAK,CAACyC,IAAN,CAAW,yBAAX,EAAsC;AAClCX,MAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADS,KAAtC;AAGH;AACJ,CA9FM;AAgGP,OAAO,MAAMU,aAAa,GAAG,MAAM;AAC/B,QAAMC,KAAK,GAAGpB,YAAY,CAACc,OAAb,CAAqB,OAArB,CAAd;;AACA,MAAIM,KAAJ,EAAW;AACP,QAAI,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,IAAxB,GAAgC5C,QAAQ,CAAC0C,KAAD,CAAR,CAAgBG,GAAnD,EAAwD;AACpD,aAAO,IAAP;AACH;AACJ;;AACD,SAAO,KAAP;AACH,CARM;AAWP,OAAO,MAAMC,eAAe,GAAG,CAACC,MAAD,EAASC,iBAAT,KAA+B;AAC1D,SAAOrC,KAAK,CAAE,GAAEV,UAAU,EAAG,qBAAoB8C,MAAO,YAAWzB,YAAY,CAACc,OAAb,CAAqB,SAArB,CAAgC,EAAvF,EAA0F;AAClGtB,IAAAA,OAAO,EAAE;AACL,sBAAgB,kBADX;AAEL,uBAAmB,UAASQ,YAAY,CAACc,OAAb,CAAqB,OAArB,CAA8B;AAFrD;AADyF,GAA1F,CAAL,CAMNlB,IANM,CAMDC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EANN,EAONF,IAPM,CAODG,IAAI,IAAI;AACV,QAAIA,IAAI,CAAC,SAAD,CAAR,EAAqB;AACjB,UAAGA,IAAI,CAAC,OAAD,CAAP,EAAkB;AACdC,QAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BF,IAAI,CAAC,OAAD,CAAlC;AACH;;AACD2B,MAAAA,iBAAiB,CAACD,MAAD,EAAS1B,IAAI,CAAC,MAAD,CAAb,CAAjB;AACH,KALD,MAKO;AACHtB,MAAAA,KAAK,CAACyC,IAAN,CAAWxB,IAAI,CAACC,SAAL,CAAeI,IAAI,CAAC,KAAD,CAAnB,CAAX,EAAwC;AACpCQ,QAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADW,OAAxC;AAGH;AACJ,GAlBM,EAmBNC,KAnBM,CAmBAC,GAAG,IAAI;AACVlC,IAAAA,KAAK,CAACyC,IAAN,CAAY,wDAAZ,EAAqE;AACjEX,MAAAA,QAAQ,EAAE9B,KAAK,CAAC+B,QAAN,CAAeC;AADwC,KAArE;AAGH,GAvBM,CAAP;AAwBH,CAzBM","sourcesContent":["import { toast } from 'react-toastify';\nimport { parseJwt } from './utils';\n\nexport const backendUrl = () => {\n    if(process.env.NODE_ENV === 'production') return process.env.REACT_APP_PRODUCTION_API;\n    return process.env.REACT_APP_DEVELOPMENT_API;\n}\n\nexport const login = (values, setSubmitting, nav) => {\n    return fetch(`${backendUrl()}/login`, {\n        method: 'POST',\n        mode: 'cors',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(values)\n    })\n    .then(res => res.json())\n    .then(data => {\n        if (data['success']) {\n            localStorage.setItem('token', data['token']);\n            localStorage.removeItem('loan-form');\n            localStorage.setItem('user_id', data['user_id'])\n            nav.push('/home');\n            toast.success('Login Successful');\n        } else {\n            toast.error(`Error: ${data.msg}`, {\n                position: toast.POSITION.BOTTOM_CENTER\n            });\n        }\n        setSubmitting(false)\n    })\n    .catch(err => {\n        toast('Something went wrong, Internet might be down');\n        setSubmitting(false)\n    });\n}\n\nexport const logout = () => {\n    let loanFormValues = localStorage.getItem('loan-form');\n    if (loanFormValues) {\n        let formId = localStorage.getItem('loan-form-id');\n        if(formId) {\n            console.log('called');\n            return fetch(`${backendUrl()}/loan/update`, {\n                method: 'POST',\n                mode: 'cors',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization' : `Bearer ${localStorage.getItem('token')}`\n                },\n                body: JSON.stringify({'data': loanFormValues, 'status': 0, 'id': formId})\n            })\n            .then(res => res.json())\n            .then(data => {\n                if (data['success']) {\n                    toast.info('Data Saved Successfully', {\n                        position: toast.POSITION.BOTTOM_CENTER\n                    });\n                } else {\n                    toast.info(`Error(${data['msg']}) in saving data, you have been logged out`, {\n                        position: toast.POSITION.BOTTOM_CENTER\n                    });\n                }\n                localStorage.removeItem('token');\n                localStorage.removeItem('loan-form');\n                localStorage.removeItem('user_id');\n                localStorage.removeItem('loan-form-id');\n\n                toast.info('Saving current form state', {\n                    position: toast.POSITION.BOTTOM_CENTER\n                });\n\n            })\n            .catch(err => {\n                toast('Something went wrong, Internet might be down');\n                localStorage.removeItem('token');\n                localStorage.removeItem('loan-form');\n                localStorage.removeItem('user_id');\n                localStorage.removeItem('loan-form-id');\n            });\n        } else {\n            console.log('Called');\n            return fetch(`${backendUrl()}/loan/apply`, {\n                method: 'POST',\n                mode: 'cors',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization' : `Bearer ${localStorage.getItem('token')}`\n                },\n                body: JSON.stringify({\n                    'data': loanFormValues,\n                    'status': 0,\n                    'user_id': localStorage.getItem('user_id')\n                })\n            })\n            .then(res => res.json())\n            .then(data => {\n                if (data['success']) {\n                    toast.info('Data Saved Successfully', {\n                        position: toast.POSITION.BOTTOM_CENTER\n                    });\n                } else {\n                    toast.error(`Error(${data['msg']}) in saving data, you have been logged out`);\n                }\n                localStorage.removeItem('token');\n                localStorage.removeItem('loan-form');\n                localStorage.removeItem('user_id');\n                localStorage.removeItem('loan-form-id');\n\n                toast.info('Saving current form state', {\n                    position: toast.POSITION.BOTTOM_CENTER\n                });\n\n            })\n            .catch(err => {\n                toast('Something went wrong, Internet might be down');\n                localStorage.removeItem('token');\n                localStorage.removeItem('loan-form');\n                localStorage.removeItem('user_id');\n                localStorage.removeItem('loan-form-id');\n            });\n        }\n    } else {\n        localStorage.removeItem('token');\n        localStorage.removeItem('loan-form');\n        localStorage.removeItem('user_id');\n        localStorage.removeItem('loan-form-id');\n        toast.info('successfully logged out', {\n            position: toast.POSITION.BOTTOM_CENTER\n        });\n    }\n}\n\nexport const authenticated = () => {\n    const token = localStorage.getItem('token');\n    if (token) {\n        if((new Date().getTime() / 1000) < parseJwt(token).exp) {\n            return true;\n        }\n    }\n    return false;\n}\n\n\nexport const getLoanByStatus = (status, handleStateChange) => {\n    return fetch(`${backendUrl()}/loan/show?status=${status}&user_id=${localStorage.getItem('user_id')}`, {\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization' : `Bearer ${localStorage.getItem('token')}`\n        }\n    })\n    .then(res => res.json())\n    .then(data => {\n        if (data['success']) {\n            if(data['token']) {\n                localStorage.setItem('token', data['token']);\n            }\n            handleStateChange(status, data['data']);\n        } else {\n            toast.info(JSON.stringify(data['msg']), {\n                position: toast.POSITION.BOTTOM_CENTER\n            });\n        }\n    })\n    .catch(err => {\n        toast.info(`Error something went wrong, check your internet status`, {\n            position: toast.POSITION.BOTTOM_CENTER\n        });\n    })\n}\n"]},"metadata":{},"sourceType":"module"}